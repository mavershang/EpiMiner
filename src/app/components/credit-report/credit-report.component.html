<div class="grid-container">
    <div class="input-container">
            <input class = "geneStrInput" type="text" placeholder="Query with Gene" name="gene" class="form-control"
                [(ngModel)]="geneInput" required maxlength="100" />

                <div class="help-tip1">
                    <p> <strong>Tips of input section</strong><br>
                        <strong>"Query with Genes"</strong><br> query with gene name (only one gene is alllowed at current stage). <br><br>
                        <strong>"Disease area"</strong><br> specify target disease which will map to a collection of predefined datasets. <br><br>
                        <strong>"Tissue for epigenomic query"</strong><br> specify tissue or celltypes to query enhancer-gene association. <br><br>
                        <strong>"Max distance"</strong><br> the flanking area of query gene used for hypercoloc analysis (genetics tab). The default is 500k. <br>
                    </p>
                </div>

        <div class="disease-select-container">
            <select class="selectDisease" style="height:100%; width:100%" [(ngModel)]="selectedDisease"
                (change)="diseaseOnChange()">
                <option value="" disabled selected> Select a disease area</option>
                <option *ngFor="let g of diseaseArr" [ngValue]="g">{{g}}</option>
            </select>
        </div>

        <div class="geneticAnalysis-selection">
            <mat-checkbox class="geneticAnalysis-checkbox"
                          [(ngModel)]="runGeneticAnalysis">
                Run Genetic HyperColoc Analysis
            </mat-checkbox>
        </div>

        <div class="tissue-selector">
            <ng-multiselect-dropdown 
                class="dropdown-list"
                [placeholder]="'Select Tissue(s) For Epigenomic query'" 
                [data]="tissueOptions"
                [settings]="dropdownSettings"
                [(ngModel)]="epiSearchParam.tissues" 
                (onSelect)="onItemSelect($event)"
                (onSelectAll)="onSelectAll($event)"
                ></ng-multiselect-dropdown>
        </div>

        <div class="dist-container">
            <label style="height:100%; width:40px">Max distance </label>
            <input type="text" style="height:90%; width:73.5%" placeholder="Epigenomic chunk to gene (default +/-500k nt)" name="maxDistColoc"
                class="form-control" [(ngModel)]="epiSearchParam.maxDist" required maxlength="20" />
        </div>

        <button class="button-submit" role="button" (click)="submitGene()">Submit</button>
    </div>

    <mat-progress-spinner style="margin:0 auto;" class="spinner" [mode]="'indeterminate'" *ngIf="loading$ | async">
    </mat-progress-spinner>

    <mat-tab-group (selectedTabChange)="tabChanged($event)">
        <mat-tab>
            <ng-template mat-tab-label>
                <span style="color:navy; font-size: 20px; font-weight: bold;">Genetics</span>
            </ng-template>
            <mat-progress-spinner *ngIf="geneticsTabLoading" class="spinner" mode="indeterminate"> </mat-progress-spinner>
            <div [ngClass]="{'tab-content': true, 'loading':geneticsTabLoading}">
            <div class="genetics-grid-container">
                <div class="table-container-hypercoloc" mat-elevation-z8>
                    <div class="genetics-table-header">
                        <h2 style="text-align: center; color:navy">HyperColoc Result Table</h2>
                        <div class="help-tip1">
                            <p>This table shows the hypercoloc analysis results using the SNPs in flanking regions of the target gene</p>
                        </div>
                    </div>

                    <mat-table matTableFilter [exampleEntity]="filterEntity" [filterType]="filterType"
                        [dataSource]="tableDataSource" matSort>
                        <ng-container matColumnDef="QueryGene">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="QueryGene" [(ngModel)]="filterEntity.QueryGene">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.QueryGene}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Iteration">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Iteration" [(ngModel)]="filterEntity.Iteration">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Iteration}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Traits">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Traits" [(ngModel)]="filterEntity.Traits">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Traits}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="PosteriorProb">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="PosteriorProb"
                                        [(ngModel)]="filterEntity.PosteriorProb">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.PosteriorProb}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="RegionalProb">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="RegionalProb" [(ngModel)]="filterEntity.RegionalProb">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.RegionalProb}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="CandidateSNP">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="CandidateSNP" [(ngModel)]="filterEntity.CandidateSNP">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.CandidateSNP}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="PosteriorExplainedBySNP">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="PosteriorExplainedBySNP"
                                        [(ngModel)]="filterEntity.PosteriorExplainedBySNP">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.PosteriorExplainedBySNP}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="DroppedTrait">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="DroppedTrait" [(ngModel)]="filterEntity.DroppedTrait">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.DroppedTrait}} </mat-cell>
                        </ng-container>

                        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: displayedColumns; let i = index;"
                            [ngClass]="{hovered: row.hovered, highlighted: row.highlighted}"
                            (click)="onRowClicked(row, i)" (mouseover)="row.hovered = true"
                            (mouseout)="row.hovered = false">
                        </mat-row>
                    </mat-table>
                    <mat-paginator #paginatorColoc [pageSizeOptions]="[10, 20, 50, 100]"
                        showFirstLastButtons></mat-paginator>
                </div>

                <div class="img-container1">
                    <h4 style="color: rgb(0, 47, 255);text-align: center;">{{lzpPhenotypes[0]}}</h4>
                    <img id="img-lpz1" [src]='lzpImgs[0]' style="width:800px;height:550px;" alt="LocusZoom Plot 1" />
                </div>

                <div class="img-container2">
                    <h4 style="color: rgb(0, 47, 255);text-align: center;">{{lzpPhenotypes[1]}}</h4>
                    <img id="img-lpz2" [src]='lzpImgs[1]' style="width:800px;height:550px;" alt="LocusZoom Plot 2" />
                </div>

                <div class="img-container3">
                    <h4 style="color: rgb(0, 47, 255);text-align: center;">{{lzpPhenotypes[2]}}</h4>
                    <img id="img-lpz3" [src]='lzpImgs[2]' style="width:800px;height:550px;" alt="LocusZoom Plot 3" />
                </div>

                <div class="img-container4">
                    <h4 style="color: rgb(0, 47, 255);text-align: center;">{{lzpPhenotypes[3]}}</h4>
                    <img id="img-lpz4" [src]='lzpImgs[3]' style="width:800px;height:550px;" alt="LocusZoom Plot 4" />
                </div>

                <div class="img-container5">
                    <h4 style="color: rgb(0, 47, 255);text-align: center;">{{lzpPhenotypes[4]}}</h4>
                    <img id="img-lpz5" [src]='lzpImgs[4]' style="width:800px;height:550px;" alt="LocusZoom Plot 5" />
                </div>
            </div>
        </div>
        </mat-tab>

        <mat-tab>
            <ng-template mat-tab-label>
                <span style="color:navy; font-size: 20px; font-weight: bold;">Epigenomics</span>
            </ng-template>
            <mat-progress-spinner *ngIf="epigenomicsTabLoading" class="spinner" mode="indeterminate"> </mat-progress-spinner>
            <div [ngClass]="{'tab-content': true, 'loading':epigenomicsTabLoading}">
            <div class="epi-grid-container">
                <div class="epiTable-container" mat-elevation-z8>
                    <h3 style="text-align: center; color:darkblue">Epigenomics Result Table</h3>
                    <mat-table matTableFilter [exampleEntity]="filterEntity2" [filterType]="filterType2"
                        [dataSource]="tableDataSource2" matSort>
                        <ng-container matColumnDef="DataSource">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="DataSource" [(ngModel)]="filterEntity2.DataSource">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.DataSource}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="DataType">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="DataType" [(ngModel)]="filterEntity2.DataType">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.DataType}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Tissue">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Tissue" [(ngModel)]="filterEntity2.Tissue">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Tissue}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="CellType">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="CellType" [(ngModel)]="filterEntity2.CellType">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.CellType}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="CellLine">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="CellLine" [(ngModel)]="filterEntity2.CellLine">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.CellLine}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Description">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Description" [(ngModel)]="filterEntity2.Description">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Description}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Chr">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Chromosome" [(ngModel)]="filterEntity2.Chr">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Chr}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="SnpPosition">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="SNP Position" [(ngModel)]="filterEntity2.SnpPosition">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.SnpPosition}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="ChunkStartPos">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Chunk Start Position"
                                        [(ngModel)]="filterEntity2.ChunkStartPos">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.ChunkStartPos}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="ChunkEndPos">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Chunk End Position"
                                        [(ngModel)]="filterEntity2.ChunkEndPos">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.ChunkEndPos}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="Gene">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="Linked Gene" [(ngModel)]="filterEntity2.Gene">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.Gene}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="EpiLinkScore">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="EpiLinkScore" [(ngModel)]="filterEntity2.EpiLinkScore">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.EpiLinkScore}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="QTLPValue">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>
                                <mat-form-field appearance="legacy">
                                    <input matInput placeholder="P-Value" [(ngModel)]="filterEntity2.QTLPValue">
                                </mat-form-field>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> {{row.QTLPValue}} </mat-cell>
                        </ng-container>

                        <mat-header-row *matHeaderRowDef="displayedColumns2; sticky: true"></mat-header-row>
                        <mat-row *matRowDef="let row; columns: displayedColumns2; let i = index;"
                            [ngClass]="{hovered: row.hovered, highlighted: row.highlighted}"
                            (click)="onRowClicked2(row, i)" (mouseover)="row.hovered = true"
                            (mouseout)="row.hovered = false">
                        </mat-row>
                    </mat-table>
                    <mat-paginator #paginatorQuery [pageSizeOptions]="[10, 20, 50, 100]"
                        showFirstLastButtons></mat-paginator>
                </div>
            </div>
            </div>
        </mat-tab>

        <mat-tab>
            <ng-template mat-tab-label>
                <span style="color:navy; font-size: 20px; font-weight: bold;">Bulk RNASeq</span>
            </ng-template>
            <mat-progress-spinner *ngIf="bulkRNASeqTabLoading" class="spinner" mode="indeterminate"> </mat-progress-spinner>
            <div [ngClass]="{'tab-content': true, 'loading':bulkRNASeqTabLoading}">
                <div *ngIf="showRNASeqGrid" class="rnaseq-grid-container">
                    <app-plot-holder-expr></app-plot-holder-expr>
                </div>
            </div>
        </mat-tab>

        <mat-tab>
            <ng-template mat-tab-label>
                <span style="color:navy; font-size: 20px; font-weight: bold;">scRNASeq</span>
            </ng-template>
            <mat-progress-spinner *ngIf="scRNASeqTabLoading" class="spinner" mode="indeterminate"> </mat-progress-spinner>
            <div class="scrnaseq-grid-container">
                <div *ngIf="showScRNASeqGrid" class="scRNASeq-grid-container">
                    <app-sc-rnaseq-holder></app-sc-rnaseq-holder>
                </div>
            </div>
        </mat-tab>

        <mat-tab>
            <ng-template mat-tab-label>
                <span style="color:navy; font-size: 20px; font-weight: bold;">Summary</span>
            </ng-template>
            <div class="scrnaseq-grid-container">
                <app-evidence-matrix></app-evidence-matrix>
            </div>
        </mat-tab>
    </mat-tab-group>
</div>